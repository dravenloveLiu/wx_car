<!--pages/car/maintenance.wxml-->
<view class="container">
  <!-- è½¦è¾†ä¿¡æ¯å¡ç‰‡ -->
  <view class="car-card" wx:if="{{car}}">
    <view class="car-info">
      <view class="car-avatar">
        <view class="car-brand">{{car.brand[0]}}</view>
      </view>
      <view class="car-detail">
        <view class="car-name">{{car.brand}} {{car.model}}</view>
        <view class="car-plate">{{car.plateNumber}}</view>
        <view class="car-meta">
          <text class="car-year">{{car.year}}å¹´</text>
          <text class="car-mileage">{{car.mileage}}å…¬é‡Œ</text>
        </view>
      </view>
    </view>
    <view class="car-action" bindtap="viewCarDetail">æŸ¥çœ‹è¯¦æƒ…</view>
  </view>

  <!-- ä¿å…»è®°å½•åˆ—è¡¨ -->
  <view class="maintenance-container">
    <view class="section-header">
      <text class="section-title">ä¿å…»è®°å½•</text>
      <view class="add-record" bindtap="addRecord">+ æ·»åŠ è®°å½•</view>
    </view>

    <!-- åŠ è½½ä¸­ -->
    <view class="loading-container" wx:if="{{loading}}">
      <view class="loading">
        <view class="loading-icon"></view>
        <text>åŠ è½½ä¸­...</text>
      </view>
    </view>

    <!-- æ— è®°å½• -->
    <view class="empty-records" wx:elif="{{maintenanceRecords.length === 0}}">
      <view class="empty-icon">ğŸ“</view>
      <text class="empty-text">æš‚æ— ä¿å…»è®°å½•</text>
      <text class="empty-subtext">æ‚¨å¯ä»¥è®°å½•è½¦è¾†çš„ä¿å…»å†å²</text>
      <view class="add-button" bindtap="addRecord">æ·»åŠ ä¿å…»è®°å½•</view>
    </view>

    <!-- è®°å½•åˆ—è¡¨ -->
    <view class="record-list" wx:else>
      <view class="record-item" 
            wx:for="{{maintenanceRecords}}" 
            wx:key="id"
            bindtap="goToDetail"
            data-id="{{item.id}}">
        <view class="record-date">
          <text class="record-day">{{item.day}}</text>
          <text class="record-month">{{item.month}}æœˆ</text>
          <text class="record-year">{{item.year}}</text>
        </view>
        <view class="record-info">
          <view class="record-type">{{item.maintenanceType}}</view>
          <view class="record-desc">{{item.description}}</view>
          <view class="record-meta">
            <text class="record-mileage">é‡Œç¨‹ï¼š{{item.mileage}}å…¬é‡Œ</text>
            <text class="record-price" wx:if="{{item.cost}}">Â¥{{item.cost}}</text>
          </view>
        </view>
        <view class="record-arrow">
          <text class="arrow">></text>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æŒ‰é’® -->
  <view class="bottom-btn" wx:if="{{!loading && maintenanceRecords.length > 0}}">
    <button class="add-record-btn" bindtap="addRecord">æ·»åŠ ä¿å…»è®°å½•</button>
  </view>
</view>