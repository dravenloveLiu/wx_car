const app = getApp()
const request = require('../../utils/request.js')

Page({
  data: {
    service: null,
    loading: true,
    id: null
  },

  onLoad(options) {
    if (options.id) {
      this.setData({
        id: options.id
      })
      this.getServiceDetail(options.id)
    }
  },

  getServiceDetail(id) {
    // 模拟数据，实际开发中应该从API获取
    const serviceData = {
      id: id,
      name: 
        id == 1 ? '节能环保机油' : 
        id == 2 ? '高性能刹车片' : 
        id == 3 ? '空调清洗套餐' :
        id == 4 ? '常规保养套餐' :
        id == 5 ? '蓄电池更换' :
        id == 6 ? '汽车打蜡美容' :
        id == 7 ? '汽车升级改装' :
        id == 8 ? '汽车喷漆修复' :
        id == 9 ? '汽车配件维修' :
        id == 10 ? '隔热窗膜安装' : '未知服务',
      desc: 
        id == 1 ? '5W-30 全合成机油，提供卓越的发动机保护' : 
        id == 2 ? '适用于多种车型，提供更佳制动性能' : 
        id == 3 ? '彻底清除异味，杀菌消毒，恢复空调清新' :
        id == 4 ? '包含机油更换、滤清器检查与更换、多项检测' :
        id == 5 ? '高品质蓄电池，提供安装服务和旧电池回收' :
        id == 6 ? '专业打蜡，恢复车漆光泽，提供长效保护' :
        id == 7 ? '个性化升级改装，提升车辆性能和外观' :
        id == 8 ? '专业喷漆，修复刮痕和车漆老化问题' :
        id == 9 ? '专业技师维修各类汽车配件，快速高效' :
        id == 10 ? '高品质隔热窗膜，阻隔紫外线，降低车内温度' : '服务描述',
      price: 
        id == 1 ? 329 : 
        id == 2 ? 499 : 
        id == 3 ? 198 :
        id == 4 ? 588 :
        id == 5 ? 799 :
        id == 6 ? 388 :
        id == 7 ? 1200 :
        id == 8 ? 1500 :
        id == 9 ? 450 :
        id == 10 ? 1280 : 100,
      oldPrice: 
        id == 1 ? 399 : 
        id == 2 ? 599 : 
        id == 3 ? 258 :
        id == 4 ? 688 :
        id == 5 ? 899 :
        id == 6 ? 468 :
        id == 7 ? 1500 :
        id == 8 ? 1800 :
        id == 9 ? 520 :
        id == 10 ? 1580 : 150,
      description: 
        id == 1 ? '采用先进技术研发的全合成机油，能有效减少发动机磨损，提高燃油效率，延长换油周期。适用于各种路况和气候条件，提供卓越的发动机保护。' :
        id == 2 ? '采用高性能陶瓷材料，具有出色的制动性能和耐久性。低噪音、低粉尘设计，适用于多种车型，安装简便，提供更稳定的制动体验。' :
        id == 3 ? '专业设备深度清洁空调系统，去除细菌、霉菌和异味。使用环保清洁剂，对车内环境无害。包含空调滤芯更换，确保空气清新健康。' :
        id == 4 ? '全面的汽车保养服务，包括机油和机油滤清器更换、空气滤清器检查、空调滤芯检查、刹车系统检查、轮胎检查和补充各种液位。我们使用高质量的保养材料，确保您的爱车保持最佳状态。' :
        id == 5 ? '我们提供高品质的汽车蓄电池，适合各种车型。服务包括专业安装、电瓶检测、充电系统测试，以及免费回收旧电池。我们的蓄电池具有长寿命和高稳定性，确保您的车辆在各种条件下都能可靠启动。' :
        id == 6 ? '专业的汽车打蜡服务，使用优质车蜡，给爱车提供长效保护。我们的服务包括车身清洁、抛光和打蜡，可以有效去除轻微划痕，恢复车漆光泽，并形成保护层抵抗紫外线和环境污染，使您的爱车焕然一新。' :
        id == 7 ? '为您的爱车提供个性化升级服务，包括外观改装、内饰升级、动力提升、音响改装等。我们的专业团队会根据您的需求和车型特点，提供最适合的升级方案，让您的爱车更具个性和实用性。' :
        id == 8 ? '专业的汽车喷漆服务，解决刮蹭、车漆褪色等问题。我们使用环保漆料，精确调色，确保修复后的漆面与原车漆完美匹配。服务包括表面处理、底漆、色漆和清漆喷涂，全面恢复车漆美观。' :
        id == 9 ? '针对各类汽车配件的专业维修服务，包括灯光系统、电子系统、底盘部件等。我们的技师经验丰富，可快速诊断问题并提供专业修复，使用原厂或高质量兼容配件，保障车辆性能和安全。' :
        id == 10 ? '高品质汽车隔热窗膜安装服务，有效阻隔紫外线和红外线，降低车内温度，提升驾乘舒适度。我们提供多种级别的窗膜选择，专业安装确保无气泡和褶皱，外观美观且经久耐用。' : 
        '服务详细描述',
      features: 
        id == 1 ? [
          '优质全合成配方',
          '提供卓越的发动机保护',
          '提高燃油效率',
          '延长换油周期'
        ] : 
        id == 2 ? [
          '高性能陶瓷材料',
          '低噪音、低粉尘设计',
          '出色的制动性能',
          '适用于多种车型'
        ] : 
        id == 3 ? [
          '深度清洁空调系统',
          '去除细菌、霉菌和异味',
          '使用环保清洁剂',
          '包含空调滤芯更换'
        ] :
        id == 4 ? [
          '全合成机油更换',
          '多项滤清器检查与更换',
          '全面安全检测',
          '免费补充玻璃水等液体'
        ] :
        id == 5 ? [
          '高品质蓄电池',
          '专业安装与调试',
          '免费电瓶检测服务',
          '旧电池环保回收'
        ] :
        id == 6 ? [
          '德国进口车蜡',
          '专业抛光技术',
          '去除轻微划痕',
          '形成持久保护层'
        ] :
        id == 7 ? [
          '个性化定制方案',
          '原厂兼容部件',
          '专业团队施工',
          '质保服务'
        ] :
        id == 8 ? [
          '专业喷漆设备',
          '环保水性漆',
          '精确调色技术',
          '多层保护工艺'
        ] :
        id == 9 ? [
          '全车配件诊断',
          '专业维修团队',
          '原厂配件供应',
          '维修质保服务'
        ] :
        id == 10 ? [
          '进口高品质窗膜',
          '99%紫外线阻隔',
          '减少车内温度',
          '专业无气泡安装'
        ] : ['特点1', '特点2', '特点3', '特点4'],
      specifications: 
        id == 1 ? [
          {name: '类型', value: '全合成机油'},
          {name: '粘度等级', value: '5W-30'},
          {name: '容量', value: '4L'},
          {name: '适用发动机', value: '汽油/柴油发动机'}
        ] : 
        id == 2 ? [
          {name: '材质', value: '高性能陶瓷'},
          {name: '适用位置', value: '前轮/后轮'},
          {name: '噪音等级', value: '低'},
          {name: '适用车型', value: '多种车型'}
        ] : 
        id == 3 ? [
          {name: '服务时长', value: '约60分钟'},
          {name: '清洁范围', value: '整个空调系统'},
          {name: '含滤芯更换', value: '是'},
          {name: '保修期', value: '3个月'}
        ] :
        id == 4 ? [
          {name: '服务时长', value: '约90分钟'},
          {name: '包含项目', value: '机油+滤清器+检测'},
          {name: '适用车型', value: '所有乘用车'},
          {name: '保修期', value: '6个月或5000公里'}
        ] :
        id == 5 ? [
          {name: '电池类型', value: '免维护铅酸/AGM'},
          {name: '服务时长', value: '约30分钟'},
          {name: '质保期', value: '24个月'},
          {name: '包含服务', value: '安装+检测+回收'}
        ] :
        id == 6 ? [
          {name: '服务时长', value: '约120分钟'},
          {name: '蜡种类型', value: '进口硬蜡'},
          {name: '施工工艺', value: '机器抛光+手工打蜡'},
          {name: '保护时间', value: '约3-6个月'}
        ] :
        id == 7 ? [
          {name: '服务类型', value: '定制升级'},
          {name: '施工时间', value: '视改装项目而定'},
          {name: '适用车型', value: '所有车型'},
          {name: '质保期', value: '12个月'}
        ] :
        id == 8 ? [
          {name: '漆料类型', value: '环保水性漆'},
          {name: '施工流程', value: '打磨+底漆+色漆+清漆'},
          {name: '干燥方式', value: '烤漆'},
          {name: '质保期', value: '24个月'}
        ] :
        id == 9 ? [
          {name: '维修范围', value: '全车电子电器配件'},
          {name: '检测方式', value: '专业电脑诊断'},
          {name: '维修时间', value: '视故障情况而定'},
          {name: '配件来源', value: '原厂/高品质兼容件'}
        ] :
        id == 10 ? [
          {name: '窗膜材质', value: '进口纳米陶瓷膜'},
          {name: '可见光透过率', value: '70%/50%/35%可选'},
          {name: '施工时间', value: '约180分钟'},
          {name: '质保期', value: '5年不泡不褪色'}
        ] : 
        [{name: '规格1', value: '值1'}, {name: '规格2', value: '值2'}],
      rating: 4.7,
      reviews: 156,
      soldCount: 521
    }

    // 模拟API请求延迟
    setTimeout(() => {
      this.setData({
        service: serviceData,
        loading: false
      })
    }, 500)
  },

  makeAppointment() {
    if (!app.globalData.isLogin) {
      wx.showModal({
        title: '提示',
        content: '预约服务需要先登录，是否前往登录？',
        success: (res) => {
          if (res.confirm) {
            wx.navigateTo({
              url: '/pages/auth/auth'
            })
          }
        }
      })
      return
    }
    wx.navigateTo({
      url: `/pages/appointment/create/create?serviceId=${this.data.id}&serviceName=${this.data.service.name}`
    })
  }
}) 